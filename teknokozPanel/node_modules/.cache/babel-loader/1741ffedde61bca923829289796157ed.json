{"ast":null,"code":"import { createStore } from 'vuex';\nimport axios from \"axios\";\nimport router from \"@/router\";\nimport authelp from \"/src/store/authelp\";\nexport default createStore({\n  state: {\n    token: '',\n    role: ''\n  },\n  getters: {\n    isAuth(state) {\n      return state.token !== '';\n    },\n\n    isRole(state) {\n      return state.role;\n    }\n\n  },\n  mutations: {\n    setToken(state, token) {\n      state.token = token;\n    },\n\n    setRole(state, role) {\n      state.role = role;\n    },\n\n    clearToken(state) {\n      state.token = '';\n      state.role = '';\n    }\n\n  },\n  actions: {\n    initAuth({\n      commit,\n      dispatch\n    }) {\n      let token = localStorage.getItem('token');\n      let role = localStorage.getItem('role');\n\n      if (token) {\n        commit(\"setToken\", token);\n        commit(\"setRole\", role);\n      } else {\n        router.push(\"/login\");\n        return false;\n      }\n    },\n\n    login({\n      commit,\n      dispatch,\n      state\n    }, authData) {\n      return axios.post('http://127.0.0.1:8000/oauth/token', {\n        username: authData.email,\n        password: authData.password,\n        grant_type: authelp.grant_type,\n        scope: '',\n        client_id: authelp.client_id,\n        client_secret: authelp.client_secret\n      }).then(response => {\n        commit(\"setToken\", response.data.access_token);\n        localStorage.setItem('token', response.data.access_token);\n        axios.get('http://127.0.0.1:8000/api/auth-user', {\n          headers: {\n            email: authData.email,\n            password: authData.password,\n            Authorization: \"Bearer \" + response.data.access_token\n          }\n        }).then(response => {\n          commit(\"setRole\", response.data.role[0].name);\n          localStorage.setItem('role', response.data.role[0].name);\n        }).catch(error => {\n          let timerInterval;\n          this.$swal.fire({\n            text: error.response.data.message,\n            timer: 1000,\n            toast: true,\n            position: 'top-end',\n            showConfirmButton: false,\n            timerProgressBar: true,\n            didOpen: () => {\n              this.Swal.showLoading();\n              const b = Swal.getHtmlContainer().querySelector('b');\n              timerInterval = setInterval(() => {\n                b.textContent = Swal.getTimerLeft();\n              }, 100);\n            },\n            willClose: () => {\n              clearInterval(timerInterval);\n            }\n          });\n        });\n        dispatch(\"setTimeOut\", +response.data.expires_in / 10);\n      });\n    },\n\n    logOut({\n      commit,\n      dispatch,\n      state\n    }) {\n      commit(\"clearToken\");\n      localStorage.removeItem('token');\n      localStorage.removeItem('role');\n      router.replace(\"/login\");\n    },\n\n    setTimeOut({\n      dispatch\n    }, expiresIn) {\n      setTimeout(() => {\n        dispatch(\"logOut\");\n      }, expiresIn);\n    }\n\n  },\n  modules: {}\n});","map":{"version":3,"names":["createStore","axios","router","authelp","state","token","role","getters","isAuth","isRole","mutations","setToken","setRole","clearToken","actions","initAuth","commit","dispatch","localStorage","getItem","push","login","authData","post","username","email","password","grant_type","scope","client_id","client_secret","then","response","data","access_token","setItem","get","headers","Authorization","name","catch","error","timerInterval","$swal","fire","text","message","timer","toast","position","showConfirmButton","timerProgressBar","didOpen","Swal","showLoading","b","getHtmlContainer","querySelector","setInterval","textContent","getTimerLeft","willClose","clearInterval","expires_in","logOut","removeItem","replace","setTimeOut","expiresIn","setTimeout","modules"],"sources":["/Users/gurhankoz/Desktop/teknokozpanel/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\nimport axios from \"axios\";\nimport router from \"@/router\";\nimport authelp from \"/src/store/authelp\";\nexport default createStore({\n  state: {\n    token: '',\n    role: '',\n  },\n  getters: {\n    isAuth(state){\n      return state.token !== '';\n    },\n    isRole(state){\n      return state.role;\n    },\n  },\n  mutations: {\n    setToken(state,token){\n      state.token = token;\n    },\n    setRole(state,role){\n      state.role = role\n    },\n    clearToken(state){\n      state.token = ''\n      state.role = ''\n    },\n  },\n  actions: {\n    initAuth({commit,dispatch}){\n      let token = localStorage.getItem('token')\n      let role = localStorage.getItem('role')\n      if(token){\n        commit(\"setToken\",token)\n        commit(\"setRole\",role)\n      }else {\n        router.push(\"/login\")\n        return false\n      }\n    },\n    login({commit,dispatch,state},authData){\n      return axios.post(\n          'http://127.0.0.1:8000/oauth/token',\n          {\n            username: authData.email,\n            password: authData.password,\n            grant_type: authelp.grant_type,\n            scope: '',\n            client_id: authelp.client_id,\n            client_secret: authelp.client_secret,\n          }).then(response => {\n            commit(\"setToken\",response.data.access_token);\n            localStorage.setItem('token',response.data.access_token)\n            axios.get('http://127.0.0.1:8000/api/auth-user',\n                {\n                  headers: {\n                    email: authData.email,\n                    password: authData.password,\n                    Authorization: \"Bearer \" + response.data.access_token\n                  }\n                }).then(response => {\n              commit(\"setRole\",response.data.role[0].name)\n              localStorage.setItem('role',response.data.role[0].name)\n            }).catch(error =>{\n              let timerInterval;\n              this.$swal.fire({\n                text: error.response.data.message,\n                timer: 1000,\n                toast:true,\n                position:'top-end',\n                showConfirmButton:false,\n                timerProgressBar: true,\n                didOpen: () => {\n                  this.Swal.showLoading()\n                  const b = Swal.getHtmlContainer().querySelector('b')\n                  timerInterval = setInterval(() => {\n                    b.textContent = Swal.getTimerLeft()\n                  }, 100)\n                },\n                willClose: () => {\n                  clearInterval(timerInterval)\n                }})\n            })\n\n            dispatch(\"setTimeOut\", +response.data.expires_in / 10)\n      })\n\n    },\n    logOut({commit,dispatch,state}){\n      commit(\"clearToken\");\n      localStorage.removeItem('token')\n      localStorage.removeItem('role')\n      router.replace(\"/login\");\n    },\n    setTimeOut({dispatch}, expiresIn){\n      setTimeout(()=>{\n        dispatch(\"logOut\")\n      },expiresIn)\n    },\n  },\n  modules: {\n  }\n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}